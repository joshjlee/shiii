<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>â™¡</title>

<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400&display=swap" rel="stylesheet">

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  height: 100vh;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  color: #cfcfcf;
  font-family: 'IBM Plex Mono', monospace;
}

.container {
  text-align: center;
  max-width: 600px;
}

h1 {
  font-size: 64px;
  font-weight: 400;
  margin-bottom: 30px;
  letter-spacing: 1px;
}

.prompt {
  font-size: 20px;
  margin-bottom: 15px;
  opacity: 0.7;
  white-space: pre-wrap; /* preserve line breaks */
}

input {
  background: transparent;
  border: none;
  border-bottom: 1px solid #777;
  color: #cfcfcf;
  font-size: 18px;
  padding: 8px;
  width: 200px;
  text-align: center;
  outline: none;
  transition: 0.3s ease;
}

input:focus {
  border-bottom: 1px solid #fff;
}

.shake {
  animation: shake 0.4s;
}

@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-6px); }
  50% { transform: translateX(6px); }
  75% { transform: translateX(-6px); }
  100% { transform: translateX(0); }
}
</style>
</head>

<body>

<div class="container">
  <h1 id="title">for xiaoshi</h1>
  <div class="prompt">from josh</div>
  <input type="password" id="passwordInput" autocomplete="off">
</div>

<!-- Off-screen YouTube Audio Container -->
<div id="youtubeAudio" style="position:absolute; left:-9999px;"></div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
const correctPassword = "hello";
const input = document.getElementById("passwordInput");
let player;

const letterLines = [
  "hi xs,",
  "",
  "i'm so glad i was able to meet you somehow",
  "",
  "from talking to you online and finally meeting you in hangzhou",
  "",
  "and every day since then",
  "",
  "i think about you",
  "",
  "even though we're different",
  "",
  "i feel like we understand each other",
  "",
  "but i want to be more like you",
  "",
  "let's spend a lot more time together",
  "",
  "so i can make you feel cared for and loved like how you do for me",
  "",
  "happy valentine's day",
  "",
  "i love you",
  "",
  "- josh",
  "p.s you're so beautiful",
  ""
];


// YouTube API
function onYouTubeIframeAPIReady() {
  player = new YT.Player('youtubeAudio', {
    height: '0',
    width: '0',
    videoId: 'Q4HyYE_cEo8',
    playerVars: { autoplay: 0, controls: 0, loop: 1, playlist: 'Q4HyYE_cEo8', modestbranding: 1 }
  });
}

// fade in music
function fadeInVolume(targetVolume = 30, duration = 3000) {
  let currentVolume = 0;
  player.setVolume(currentVolume);
  player.unMute();

  const step = targetVolume / (duration / 100);
  const interval = setInterval(() => {
    currentVolume += step;
    if (currentVolume >= targetVolume) {
      currentVolume = targetVolume;
      clearInterval(interval);
    }
    player.setVolume(Math.round(currentVolume));
  }, 100);
}

// type out letter line by line
function typeLetter() {
  const prompt = document.querySelector(".prompt");
  prompt.innerHTML = "";
  let i = 0;

  function nextLine() {
    if (i >= letterLines.length) return;
    prompt.innerHTML += letterLines[i] + "\n";
    i++;
    setTimeout(nextLine, 400); // adjust speed here (ms between lines)
  }

  nextLine();
}

input.addEventListener("keypress", function(e) {
  if (e.key === "Enter") {
    if (input.value === correctPassword) {

      // play music
      if (player && player.playVideo) {
        player.playVideo();
        fadeInVolume(30, 3000);
      }

      // fade out input
      input.style.opacity = "0";

      // remove the "for xiaoshi" title
      const title = document.getElementById("title");
      if (title) title.style.display = "none";
      
      // type the letter
      const prompt = document.querySelector(".prompt");
      prompt.style.opacity = "0";
      setTimeout(() => {
        prompt.style.opacity = "1";
        typeLetter();
      }, 800);

    } else {
      input.classList.add("shake");
      setTimeout(() => input.classList.remove("shake"), 400);
      input.value = "";
    }
  }
});
</script>

</body>
</html>
